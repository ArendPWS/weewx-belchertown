#errorCatcher Echo
#encoding UTF-8
#set global $page = "graphs"

    #include "header.html.tmpl"

    <div class="site-inner">
        <div class="content-sidebar-wrap">
            <main class="content">	
                <article class="weewx graphs page type-page status-publish entry" itemscope itemtype="https://schema.org/CreativeWork">
                    <div class="entry-content" itemprop="text">

                        <script type="text/javascript">
                            // Document ready calls        
                            jQuery(document).ready(function() {
                                var graph = getSearchParams("graph");
                                
                                if ( graph == "today" ) {
                                    showToday();
                                } else if ( graph == "week" ) {
                                    showWeek();
                                } else if ( graph == "month" ) {
                                    showMonth();
                                } else if ( graph == "year" ) {
                                    showYear();
                                } else {
                                    // No match, show daily
                                    showToday();
                                }
                                jQuery('button.wx-btn-today').click(function() {
                                    showToday();
                                });
                                
                                jQuery('button.wx-btn-week').click(function() {
                                    showWeek();
                                });
                                
                                jQuery('button.wx-btn-month').click(function() {
                                    showMonth();
                                });
                                
                                jQuery('button.wx-btn-year').click(function() {
                                    showYear();
                                });
                            });
                            
                            // Get the URL Var so we can show the right NOAA file.
                            // Source: https://stackoverflow.com/a/26744533/1177153
                            function getSearchParams(k) {
                                var p={};
                                location.search.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(s,k,v){p[k]=v});
                                return k?p[k]:p;
                            }
                            
                            function showToday() {
                                daily(); // Load daily highcharts
                                //jQuery(".wx-graph-text").text("today");
                                jQuery(".wx-graph-text").html("<a href='./?graph=today'>today</a>");
                                jQuery(".chart_day").show();
                                jQuery(".chart_week").hide();
                                jQuery(".chart_month").hide();
                                jQuery(".chart_year").hide();
                            }
                            
                            function showWeek() {
                                weekly(); // Load weekly highcharts
                                //jQuery(".wx-graph-text").text("this week");
                                jQuery(".wx-graph-text").html("<a href='./?graph=week'>this week</a>");
                                jQuery(".chart_day").hide();
                                jQuery(".chart_week").show();
                                jQuery(".chart_month").hide();
                                jQuery(".chart_year").hide();
                            }
                            
                            function showMonth() {
                                monthly(); // Load monthly highcharts
                                //jQuery(".wx-graph-text").text("this month");
                                jQuery(".wx-graph-text").html("<a href='./?graph=month'>this month</a>");
                                jQuery(".chart_day").hide();
                                jQuery(".chart_week").hide();
                                jQuery(".chart_month").show();
                                jQuery(".chart_year").hide();
                            }
                            
                            function showYear() {
                                yearly(); // Load yearly highcharts
                                //jQuery(".wx-graph-text").text("this year");
                                jQuery(".wx-graph-text").html("<a href='./?graph=year'>this year</a>");
                                jQuery(".chart_day").hide();
                                jQuery(".chart_week").hide();
                                jQuery(".chart_month").hide();
                                jQuery(".chart_year").show();
                            }
                                
                        </script>
                        
                        #include "page-header.inc"

                        <!-- Begin row -->
                        <div class="row">
                            <div class="col-sm-12 wx-buttons">
                                <button type="button" class="btn btn-primary wx-btn-today">Today</button> <button type="button" class="btn btn-primary wx-btn-week">Week</button> <button type="button" class="btn btn-primary wx-btn-month">Month</button> <button type="button" class="btn btn-primary wx-btn-year">Year</button>
                            </div>
                            <div class="col-sm-12 wx-buttons-description">
                                Graphs for <span class='wx-graph-text'><a href='./?graph=today'>today</a></span>
                            </div>
                        </div>
                        <!-- End row -->
                        
                        #for $timespan in $charts
                        
                        #for $plotname in $charts[$timespan]
                        #if $timespan == "day"
                        <div id="$timespan$plotname" class="chart_$timespan" style="width:100%; height:350px;"></div>
                        #else
                        <div id="$timespan$plotname" class="chart_$timespan" style="width:100%; height:350px;display:none;"></div>
                        #end if
                        #end for
                        
                        #end for
                        
                        <div class="clear"></div>
                    
                    </div>
                </article>
            </main>
        </div>
    </div>


    #include "footer.html.tmpl"

